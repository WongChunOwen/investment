[
  {
    "objectID": "week_03_lab_note.html",
    "href": "week_03_lab_note.html",
    "title": "Week 03 Lab Learning Notes – ‘PostgreSQL’ Queries for Joining Tables",
    "section": "",
    "text": "Here we have 2 tables\n\n\n\nTable 1: Shareholder information\n\n\nsh_holder_id\nsh_holder_name\ncountry\nis_indiv\n\n\n\n\n1\nHaha Holdings Hub\nHungary\n0\n\n\n2\nLaughingStock Holdings, Inc.\nCanada\n0\n\n\n3\nLi Mei\nSingapore\n1\n\n\n4\nLOL Finance Firm\nSingapore\n0\n\n\n5\nNeha Patel\nIndia\n1\n\n\n6\nNurul Hidayah\nMalaysia\n1\n\n\n7\nPonzi Pyramid Pension Portfolio\nAustralia\n0\n\n\n8\nRajesh Kumar\nIndia\n1\n\n\n\n\n\n\nTable 2: Companies traded on the stock market\n\n\n\n\n\n\n\n\n\ncomp_id\ncomp_name\ncountry\nsector\nincorp_date\n\n\n\n\n1\nAbsurd Assets Associates\nSingapore\nFinance\n1999-09-19\n\n\n2\nByteMe Up Tech\nIndia\nTechnology\n2005-08-15\n\n\n3\nLaughingStock Holdings, Inc.\nCanada\nFinance\n1997-01-01\n\n\n4\nLOL Finance Firm\nSingapore\nFinance\n2012-06-30\n\n\n5\nLoony Loot National Bank\nUnited Kingdom\nFinance\n2010-04-22\n\n\n6\nMagnetic Maverick Megacorp.\nAustralia\nTechnology\n2008-11-10\n\n\n7\nMaple Syrup Bandits Inc.\nCanada\nFood\n1986-12-31\n\n\n8\nSwiss Cheese Smuggling Syndicate\nSwitzerland\nFood\n1948-03-27\n\n\n9\nWitty Widgets Worldwide\nSwitzerland\nManufacturing\n2015-02-03\n\n\n\n\n\n\n\n\n2 records\n\n\nsh_holder_id\nsh_holder_name\ncomp_id\n\n\n\n\n2\nLaughingStock Holdings, Inc.\n3\n\n\n4\nLOL Finance Firm\n4\n\n\n\n\n\n\n\n\nWe have another table\n\n\n\nTable 3: Information on products sold by the companies in the traded_companies table\n\n\ncomp_id\nprod_name\nprice\n\n\n\n\n2\nByteMate Virtual Reality Headset\n498.69\n\n\n5\nSilly Saver Certificate of Deposit\n100.00\n\n\n6\nHyperMagneto Flying Drone\n49.99\n\n\n6\nNebulaForce Magnetic Motor\n243.50\n\n\n9\nSmart Spark Gadget\n9.99\n\n\n9\nWittyWatch\n599.75\n\n\n9\nWittyWatch Pro\n799.75\n\n\n\n\n\n\n\n\n7 records\n\n\n\n\n\n\n\ncomp_name\ncomp_id\nprod_name\n\n\n\n\nByteMe Up Tech\n2\nByteMate Virtual Reality Headset\n\n\nLoony Loot National Bank\n5\nSilly Saver Certificate of Deposit\n\n\nMagnetic Maverick Megacorp.\n6\nHyperMagneto Flying Drone\n\n\nMagnetic Maverick Megacorp.\n6\nNebulaForce Magnetic Motor\n\n\nWitty Widgets Worldwide\n9\nSmart Spark Gadget\n\n\nWitty Widgets Worldwide\n9\nWittyWatch\n\n\nWitty Widgets Worldwide\n9\nWittyWatch Pro\n\n\n\n\n\n\n\n\n\n\n\n9 records\n\n\n\n\n\n\n\nsh_holder_name\ncountry\ncomp_name\n\n\n\n\nLaughingStock Holdings, Inc.\nCanada\nLaughingStock Holdings, Inc.\n\n\nLaughingStock Holdings, Inc.\nCanada\nMaple Syrup Bandits Inc.\n\n\nLi Mei\nSingapore\nAbsurd Assets Associates\n\n\nLi Mei\nSingapore\nLOL Finance Firm\n\n\nLOL Finance Firm\nSingapore\nAbsurd Assets Associates\n\n\nLOL Finance Firm\nSingapore\nLOL Finance Firm\n\n\nNeha Patel\nIndia\nByteMe Up Tech\n\n\nPonzi Pyramid Pension Portfolio\nAustralia\nMagnetic Maverick Megacorp.\n\n\nRajesh Kumar\nIndia\nByteMe Up Tech"
  },
  {
    "objectID": "week_03_lab_note.html#inner-joins",
    "href": "week_03_lab_note.html#inner-joins",
    "title": "Week 03 Lab Learning Notes – ‘PostgreSQL’ Queries for Joining Tables",
    "section": "",
    "text": "Here we have 2 tables\n\n\n\nTable 1: Shareholder information\n\n\nsh_holder_id\nsh_holder_name\ncountry\nis_indiv\n\n\n\n\n1\nHaha Holdings Hub\nHungary\n0\n\n\n2\nLaughingStock Holdings, Inc.\nCanada\n0\n\n\n3\nLi Mei\nSingapore\n1\n\n\n4\nLOL Finance Firm\nSingapore\n0\n\n\n5\nNeha Patel\nIndia\n1\n\n\n6\nNurul Hidayah\nMalaysia\n1\n\n\n7\nPonzi Pyramid Pension Portfolio\nAustralia\n0\n\n\n8\nRajesh Kumar\nIndia\n1\n\n\n\n\n\n\nTable 2: Companies traded on the stock market\n\n\n\n\n\n\n\n\n\ncomp_id\ncomp_name\ncountry\nsector\nincorp_date\n\n\n\n\n1\nAbsurd Assets Associates\nSingapore\nFinance\n1999-09-19\n\n\n2\nByteMe Up Tech\nIndia\nTechnology\n2005-08-15\n\n\n3\nLaughingStock Holdings, Inc.\nCanada\nFinance\n1997-01-01\n\n\n4\nLOL Finance Firm\nSingapore\nFinance\n2012-06-30\n\n\n5\nLoony Loot National Bank\nUnited Kingdom\nFinance\n2010-04-22\n\n\n6\nMagnetic Maverick Megacorp.\nAustralia\nTechnology\n2008-11-10\n\n\n7\nMaple Syrup Bandits Inc.\nCanada\nFood\n1986-12-31\n\n\n8\nSwiss Cheese Smuggling Syndicate\nSwitzerland\nFood\n1948-03-27\n\n\n9\nWitty Widgets Worldwide\nSwitzerland\nManufacturing\n2015-02-03\n\n\n\n\n\n\n\n\n2 records\n\n\nsh_holder_id\nsh_holder_name\ncomp_id\n\n\n\n\n2\nLaughingStock Holdings, Inc.\n3\n\n\n4\nLOL Finance Firm\n4\n\n\n\n\n\n\n\n\nWe have another table\n\n\n\nTable 3: Information on products sold by the companies in the traded_companies table\n\n\ncomp_id\nprod_name\nprice\n\n\n\n\n2\nByteMate Virtual Reality Headset\n498.69\n\n\n5\nSilly Saver Certificate of Deposit\n100.00\n\n\n6\nHyperMagneto Flying Drone\n49.99\n\n\n6\nNebulaForce Magnetic Motor\n243.50\n\n\n9\nSmart Spark Gadget\n9.99\n\n\n9\nWittyWatch\n599.75\n\n\n9\nWittyWatch Pro\n799.75\n\n\n\n\n\n\n\n\n7 records\n\n\n\n\n\n\n\ncomp_name\ncomp_id\nprod_name\n\n\n\n\nByteMe Up Tech\n2\nByteMate Virtual Reality Headset\n\n\nLoony Loot National Bank\n5\nSilly Saver Certificate of Deposit\n\n\nMagnetic Maverick Megacorp.\n6\nHyperMagneto Flying Drone\n\n\nMagnetic Maverick Megacorp.\n6\nNebulaForce Magnetic Motor\n\n\nWitty Widgets Worldwide\n9\nSmart Spark Gadget\n\n\nWitty Widgets Worldwide\n9\nWittyWatch\n\n\nWitty Widgets Worldwide\n9\nWittyWatch Pro\n\n\n\n\n\n\n\n\n\n\n\n9 records\n\n\n\n\n\n\n\nsh_holder_name\ncountry\ncomp_name\n\n\n\n\nLaughingStock Holdings, Inc.\nCanada\nLaughingStock Holdings, Inc.\n\n\nLaughingStock Holdings, Inc.\nCanada\nMaple Syrup Bandits Inc.\n\n\nLi Mei\nSingapore\nAbsurd Assets Associates\n\n\nLi Mei\nSingapore\nLOL Finance Firm\n\n\nLOL Finance Firm\nSingapore\nAbsurd Assets Associates\n\n\nLOL Finance Firm\nSingapore\nLOL Finance Firm\n\n\nNeha Patel\nIndia\nByteMe Up Tech\n\n\nPonzi Pyramid Pension Portfolio\nAustralia\nMagnetic Maverick Megacorp.\n\n\nRajesh Kumar\nIndia\nByteMe Up Tech"
  },
  {
    "objectID": "week_03_lab_note.html#outer-joins",
    "href": "week_03_lab_note.html#outer-joins",
    "title": "Week 03 Lab Learning Notes – ‘PostgreSQL’ Queries for Joining Tables",
    "section": "2 Outer Joins",
    "text": "2 Outer Joins\n\n2.1 Left Joins\n\n\n\nDisplaying records 1 - 10\n\n\n\n\n\n\n\nsh_holder_name\ncountry\ncomp_name\n\n\n\n\nHaha Holdings Hub\nHungary\nNA\n\n\nLaughingStock Holdings, Inc.\nCanada\nLaughingStock Holdings, Inc.\n\n\nLaughingStock Holdings, Inc.\nCanada\nMaple Syrup Bandits Inc.\n\n\nLi Mei\nSingapore\nAbsurd Assets Associates\n\n\nLi Mei\nSingapore\nLOL Finance Firm\n\n\nLOL Finance Firm\nSingapore\nAbsurd Assets Associates\n\n\nLOL Finance Firm\nSingapore\nLOL Finance Firm\n\n\nNeha Patel\nIndia\nByteMe Up Tech\n\n\nNurul Hidayah\nMalaysia\nNA\n\n\nPonzi Pyramid Pension Portfolio\nAustralia\nMagnetic Maverick Megacorp.\n\n\n\n\n\n\n\n2.2 Right Joins\n\n\n\nDisplaying records 1 - 10\n\n\n\n\n\n\n\nsh_holder_name\ncountry\ncomp_name\n\n\n\n\nLaughingStock Holdings, Inc.\nCanada\nLaughingStock Holdings, Inc.\n\n\nLaughingStock Holdings, Inc.\nCanada\nMaple Syrup Bandits Inc.\n\n\nLi Mei\nSingapore\nAbsurd Assets Associates\n\n\nLi Mei\nSingapore\nLOL Finance Firm\n\n\nLOL Finance Firm\nSingapore\nAbsurd Assets Associates\n\n\nLOL Finance Firm\nSingapore\nLOL Finance Firm\n\n\nNeha Patel\nIndia\nByteMe Up Tech\n\n\nPonzi Pyramid Pension Portfolio\nAustralia\nMagnetic Maverick Megacorp.\n\n\nRajesh Kumar\nIndia\nByteMe Up Tech\n\n\nNA\nUnited Kingdom\nLoony Loot National Bank\n\n\n\n\n\n\n\n2.3 Full Outer Joins\n\n\n\nDisplaying records 1 - 10\n\n\n\n\n\n\n\nsh_holder_name\ncomp_name\ncountry\n\n\n\n\nHaha Holdings Hub\nNA\nHungary\n\n\nLaughingStock Holdings, Inc.\nLaughingStock Holdings, Inc.\nCanada\n\n\nLaughingStock Holdings, Inc.\nMaple Syrup Bandits Inc.\nCanada\n\n\nLi Mei\nAbsurd Assets Associates\nSingapore\n\n\nLi Mei\nLOL Finance Firm\nSingapore\n\n\nLOL Finance Firm\nAbsurd Assets Associates\nSingapore\n\n\nLOL Finance Firm\nLOL Finance Firm\nSingapore\n\n\nNeha Patel\nByteMe Up Tech\nIndia\n\n\nNurul Hidayah\nNA\nMalaysia\n\n\nPonzi Pyramid Pension Portfolio\nMagnetic Maverick Megacorp.\nAustralia"
  },
  {
    "objectID": "week_03_lab_note.html#filtering-joins",
    "href": "week_03_lab_note.html#filtering-joins",
    "title": "Week 03 Lab Learning Notes – ‘PostgreSQL’ Queries for Joining Tables",
    "section": "3 Filtering Joins",
    "text": "3 Filtering Joins\n\n3.1 Filter Joins\n\n\n\n6 records\n\n\nsh_holder_name\ncountry\n\n\n\n\nLaughingStock Holdings, Inc.\nCanada\n\n\nLi Mei\nSingapore\n\n\nLOL Finance Firm\nSingapore\n\n\nNeha Patel\nIndia\n\n\nPonzi Pyramid Pension Portfolio\nAustralia\n\n\nRajesh Kumar\nIndia\n\n\n\n\n\n\n\n3.2 Anti-Joins\n\n\n\n2 records\n\n\nsh_holder_name\ncountry\n\n\n\n\nHaha Holdings Hub\nHungary\n\n\nNurul Hidayah\nMalaysia"
  },
  {
    "objectID": "week_03_lab_note.html#exercises-switching-tables-in-filtering-joins",
    "href": "week_03_lab_note.html#exercises-switching-tables-in-filtering-joins",
    "title": "Week 03 Lab Learning Notes – ‘PostgreSQL’ Queries for Joining Tables",
    "section": "4 Exercises — Switching Tables in Filtering Joins",
    "text": "4 Exercises — Switching Tables in Filtering Joins\n\nIn Section 3.1, a semi-join was performed based on the country column with shareholders as the left table and traded_companies as the right table. What would happen if the tables were switched?\n\nAnswer: it will produced a different table\nResult:\n\n\n\n6 records\n\n\ncomp_id\ncountry\n\n\n\n\n1\nSingapore\n\n\n2\nIndia\n\n\n3\nCanada\n\n\n4\nSingapore\n\n\n6\nAustralia\n\n\n7\nCanada\n\n\n\n\n\n\nRepeat the exercise for the anti-join in Section 3.2\n\nResult:\n\n\n\n3 records\n\n\ncomp_id\ncountry\n\n\n\n\n5\nUnited Kingdom\n\n\n8\nSwitzerland\n\n\n9\nSwitzerland"
  },
  {
    "objectID": "week_01_lab_note.html",
    "href": "week_01_lab_note.html",
    "title": "My First Quarto Document",
    "section": "",
    "text": "This is my first Quarto document. It is a simple HTML page with a table of contents.\n\n\nThis is the first section of the document.\n\n\n\nThis is the second section of the document."
  },
  {
    "objectID": "week_01_lab_note.html#section-1",
    "href": "week_01_lab_note.html#section-1",
    "title": "My First Quarto Document",
    "section": "",
    "text": "This is the first section of the document."
  },
  {
    "objectID": "week_01_lab_note.html#section-2",
    "href": "week_01_lab_note.html#section-2",
    "title": "My First Quarto Document",
    "section": "",
    "text": "This is the second section of the document."
  },
  {
    "objectID": "week_02_lab_note.html",
    "href": "week_02_lab_note.html",
    "title": "Creating website",
    "section": "",
    "text": "Week 02\nPlease go to this link"
  },
  {
    "objectID": "week_04_lab_note.html",
    "href": "week_04_lab_note.html",
    "title": "Week 04 Lab Lab Notes – Sample ‘PostgreSQL’ questions Queries for Joining Tables",
    "section": "",
    "text": "List all flights that were delayed more than 30 minutes on departure.\n\n\nSELECT *\nFROM flights\nWHERE dep_delay &gt; 30;\n\n\nDisplaying records 1 - 10\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nyear\nmonth\nday\ndep_time\nsched_dep_time\ndep_delay\narr_time\nsched_arr_time\narr_delay\ncarrier\nflight\ntailnum\norigin\ndest\nair_time\ndistance\nhour\nminute\ntime_hour\n\n\n\n\n2013\n1\n1\n732\n645\n47\n1011\n941\n30\nUA\n1111\nN37456\nEWR\nMCO\n145\n937\n6\n45\n2013-01-01 11:00:00\n\n\n2013\n1\n1\n957\n733\n144\n1056\n853\n123\nUA\n856\nN534UA\nEWR\nBOS\n37\n200\n7\n33\n2013-01-01 12:00:00\n\n\n2013\n1\n1\n1025\n951\n34\n1258\n1302\n-4\nUA\n501\nN437UA\nEWR\nMCO\n137\n937\n9\n51\n2013-01-01 14:00:00\n\n\n2013\n1\n1\n1114\n900\n134\n1447\n1222\n145\nUA\n1086\nN76502\nLGA\nIAH\n248\n1416\n9\n0\n2013-01-01 14:00:00\n\n\n2013\n1\n1\n1120\n944\n96\n1331\n1213\n78\nEV\n4495\nN16561\nEWR\nSAV\n117\n708\n9\n44\n2013-01-01 14:00:00\n\n\n2013\n1\n1\n1253\n1212\n41\n1524\n1436\n48\nUA\n754\nN576UA\nEWR\nDEN\n252\n1605\n12\n12\n2013-01-01 17:00:00\n\n\n2013\n1\n1\n1304\n1227\n37\n1518\n1422\n56\nEV\n4640\nN19966\nEWR\nDAY\n107\n533\n12\n27\n2013-01-01 17:00:00\n\n\n2013\n1\n1\n1337\n1220\n77\n1649\n1531\n78\nB6\n673\nN636JB\nJFK\nLAX\n352\n2475\n12\n20\n2013-01-01 17:00:00\n\n\n2013\n1\n1\n1355\n1315\n40\n1538\n1452\n46\nEV\n4552\nN13958\nEWR\nGSO\n86\n445\n13\n15\n2013-01-01 18:00:00\n\n\n2013\n1\n1\n1356\n1259\n57\n1538\n1438\n60\nUA\n32\nN17128\nEWR\nORD\n135\n719\n12\n59\n2013-01-01 17:00:00\n\n\n\n\n\n\nRetrieve the flight number, carrier name, and destination airport for all flights that departed from EWR (Newark Liberty International Airport).\n\n\nSELECT f.flight, a.name, f.dest\nFROM flights f\nJOIN airlines a ON f.carrier = a.carrier\nWHERE origin = 'EWR';\n\n\nDisplaying records 1 - 10\n\n\nflight\nname\ndest\n\n\n\n\n1545\nUnited Air Lines Inc.\nIAH\n\n\n1696\nUnited Air Lines Inc.\nORD\n\n\n507\nJetBlue Airways\nFLL\n\n\n1124\nUnited Air Lines Inc.\nSFO\n\n\n1187\nUnited Air Lines Inc.\nLAS\n\n\n343\nJetBlue Airways\nPBI\n\n\n1895\nAmerican Airlines Inc.\nMIA\n\n\n1077\nUnited Air Lines Inc.\nMIA\n\n\n575\nDelta Air Lines Inc.\nATL\n\n\n245\nUS Airways Inc.\nPHX\n\n\n\n\n\n\nFind the average arrival delay for each carrier.\n\n\nSELECT carrier, AVG(arr_delay) AS avg_arr_delay\nFROM flights\nGROUP BY carrier;\n\n\nDisplaying records 1 - 10\n\n\ncarrier\navg_arr_delay\n\n\n\n\n9E\n7.379669\n\n\nAA\n0.204878\n\n\nAS\n-9.930889\n\n\nB6\n9.603291\n\n\nDL\n1.887704\n\n\nEV\n15.796431\n\n\nF9\n21.755520\n\n\nFL\n19.521202\n\n\nHA\n-6.915205\n\n\nMQ\n7.900958\n\n\n\n\n\n\nList the tail number, manufacturer, and model of planes that have flights departing from LGA (LaGuardia Airport).\n\n\nSELECT DISTINCT p.tailnum, p.manufacturer, p.model\nFROM flights f\nJOIN planes p ON f.tailnum = p.tailnum\nWHERE f.origin = 'LGA';\n\n\nDisplaying records 1 - 10\n\n\ntailnum\nmanufacturer\nmodel\n\n\n\n\nN502MJ\nBOMBARDIER INC\nCL-600-2C10\n\n\nN14923\nEMBRAER\nEMB-145LR\n\n\nN627JB\nAIRBUS\nA320-232\n\n\nN953DN\nMCDONNELL DOUGLAS\nMD-90-30\n\n\nN8665A\nBOMBARDIER INC\nCL-600-2B19\n\n\nN8587E\nBOMBARDIER INC\nCL-600-2B19\n\n\nN12218\nBOEING\n737-824\n\n\nN557NW\nBOEING\n757-251\n\n\nN825AS\nCANADAIR\nCL-600-2B19\n\n\nN389DA\nBOEING\n737-832\n\n\n\n\n\n\nRetrieve the flight number, origin, destination, and the name of the destination airport for flights that traveled more than 1000 miles.\n\n\nSELECT f.flight, f.origin, f.dest, a.name AS destination_airport_name\nFROM flights f\nJOIN airports a ON f.dest = a.faa\nWHERE f.distance &gt; 1000;\n\n\nDisplaying records 1 - 10\n\n\nflight\norigin\ndest\ndestination_airport_name\n\n\n\n\n1545\nEWR\nIAH\nGeorge Bush Intercontinental\n\n\n1714\nLGA\nIAH\nGeorge Bush Intercontinental\n\n\n1141\nJFK\nMIA\nMiami Intl\n\n\n507\nEWR\nFLL\nFort Lauderdale Hollywood Intl\n\n\n49\nJFK\nPBI\nPalm Beach Intl\n\n\n71\nJFK\nTPA\nTampa Intl\n\n\n194\nJFK\nLAX\nLos Angeles Intl\n\n\n1124\nEWR\nSFO\nSan Francisco Intl\n\n\n1187\nEWR\nLAS\nMc Carran Intl\n\n\n371\nLGA\nFLL\nFort Lauderdale Hollywood Intl\n\n\n\n\n\n\nFind all planes that are in the planes table but did not have any recorded flights in the flights table.\n\n\nSELECT p.tailnum, p.manufacturer, p.model\nFROM planes p\nLEFT JOIN flights f ON p.tailnum = f.tailnum\nWHERE f.tailnum IS NULL;\n\n\n0 records\n\n\ntailnum\nmanufacturer\nmodel\n\n\n\n\n\n\n\n\nFor each day, count the number of flights that were scheduled to depart.\n\n\nSELECT DATE_TRUNC('day', time_hour) AS day, COUNT(*) AS num_flights\nFROM flights\nGROUP BY DATE_TRUNC('day', time_hour)\nORDER BY day;\n\n\nDisplaying records 1 - 10\n\n\nday\nnum_flights\n\n\n\n\n2013-01-01\n566\n\n\n2013-01-02\n764\n\n\n2013-01-03\n750\n\n\n2013-01-04\n743\n\n\n2013-01-05\n624\n\n\n2013-01-06\n638\n\n\n2013-01-07\n760\n\n\n2013-01-08\n746\n\n\n2013-01-09\n737\n\n\n2013-01-10\n765\n\n\n\n\n\n\nList the flights along with their corresponding weather conditions at the origin airport for January 1, 2013.\n\n\nSELECT f.flight, f.origin, w.temp, w.precip, w.wind_speed\nFROM flights f\nJOIN weather w ON f.origin = w.origin AND f.year = w.year AND f.month = w.month AND f.day = w.day AND f.hour = w.hour\nWHERE f.year = 2013 AND f.month = 1 AND f.day = 1;\n\n\nDisplaying records 1 - 10\n\n\nflight\norigin\ntemp\nprecip\nwind_speed\n\n\n\n\n1696\nEWR\n39.02\n0\n12.65858\n\n\n1545\nEWR\n39.02\n0\n12.65858\n\n\n1806\nJFK\n39.02\n0\n14.96014\n\n\n1141\nJFK\n39.02\n0\n14.96014\n\n\n1714\nLGA\n39.92\n0\n14.96014\n\n\n1701\nEWR\n37.94\n0\n11.50780\n\n\n507\nEWR\n37.94\n0\n11.50780\n\n\n1496\nEWR\n37.94\n0\n11.50780\n\n\n1111\nEWR\n37.94\n0\n11.50780\n\n\n1187\nEWR\n37.94\n0\n11.50780\n\n\n\n\n\n\nFind the carriers that have an average departure delay of more than 10 minutes. Find the carriers that have an average departure delay of more than 10 minutes.\n\n\nSELECT carrier, AVG(dep_delay) AS avg_dep_delay\nFROM flights\nGROUP BY carrier\nHAVING AVG(dep_delay) &gt; 10;\n\n\nDisplaying records 1 - 10\n\n\ncarrier\navg_dep_delay\n\n\n\n\n9E\n16.72577\n\n\nB6\n13.18561\n\n\nEV\n19.95539\n\n\nF9\n20.08976\n\n\nFL\n18.28609\n\n\nOO\n12.58621\n\n\nUA\n12.11433\n\n\nVX\n12.86942\n\n\nWN\n17.71983\n\n\nYV\n18.99633\n\n\n\n\n\n\nRetrieve the flight number, departure time, scheduled departure time, and manufacturer of planes that departed with a delay of more than 60 minutes.\n\n\nSELECT f.flight, f.dep_time, f.sched_dep_time, p.manufacturer\nFROM flights f\nJOIN planes p ON f.tailnum = p.tailnum\nWHERE f.dep_delay &gt; 60;\n\n\nDisplaying records 1 - 10\n\n\nflight\ndep_time\nsched_dep_time\nmanufacturer\n\n\n\n\n856\n957\n733\nBOEING\n\n\n1086\n1114\n900\nBOEING\n\n\n4495\n1120\n944\nEMBRAER\n\n\n673\n1337\n1220\nAIRBUS\n\n\n4869\n1400\n1250\nBOMBARDIER INC\n\n\n4497\n1505\n1310\nEMBRAER\n\n\n525\n1525\n1340\nEMBRAER\n\n\n4181\n1549\n1445\nEMBRAER\n\n\n5712\n1558\n1359\nCANADAIR\n\n\n465\n1607\n1443\nAIRBUS INDUSTRIE\n\n\n\n\n\n\nList all flights that departed after the average departure time on January 1, 2013.\n\n\nSELECT *\nFROM flights\nWHERE dep_time &gt; (\n    SELECT AVG(dep_time)\n    FROM flights\n    WHERE year = 2013 AND month = 1 AND day = 1\n) AND year = 2013 AND month = 1 AND day = 1;\n\n\nDisplaying records 1 - 10\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nyear\nmonth\nday\ndep_time\nsched_dep_time\ndep_delay\narr_time\nsched_arr_time\narr_delay\ncarrier\nflight\ntailnum\norigin\ndest\nair_time\ndistance\nhour\nminute\ntime_hour\n\n\n\n\n2013\n1\n1\n1400\n1250\n70\n1645\n1502\n103\nEV\n4869\nN748EV\nLGA\nMEM\n178\n963\n12\n50\n2013-01-01 17:00:00\n\n\n2013\n1\n1\n1400\n1400\n0\n1634\n1636\n-2\nDL\n2247\nN6704Z\nLGA\nATL\n130\n762\n14\n0\n2013-01-01 19:00:00\n\n\n2013\n1\n1\n1402\n1323\n39\n1650\n1526\n84\nEV\n4516\nN13123\nEWR\nMEM\n183\n946\n13\n23\n2013-01-01 18:00:00\n\n\n2013\n1\n1\n1408\n1411\n-3\n1646\n1640\n6\nFL\n349\nN895AT\nLGA\nATL\n133\n762\n14\n11\n2013-01-01 19:00:00\n\n\n2013\n1\n1\n1411\n1315\n56\n1717\n1611\n66\nB6\n505\nN516JB\nEWR\nFLL\n154\n1065\n13\n15\n2013-01-01 18:00:00\n\n\n2013\n1\n1\n1416\n1411\n5\n1603\n1549\n14\nUA\n683\nN456UA\nEWR\nORD\n136\n719\n14\n11\n2013-01-01 19:00:00\n\n\n2013\n1\n1\n1418\n1419\n-1\n1726\n1732\n-6\nUA\n16\nN37464\nEWR\nSEA\n348\n2402\n14\n19\n2013-01-01 19:00:00\n\n\n2013\n1\n1\n1421\n1422\n-1\n1517\n1535\n-18\nB6\n1010\nN274JB\nJFK\nBOS\n38\n187\n14\n22\n2013-01-01 19:00:00\n\n\n2013\n1\n1\n1421\n1355\n26\n1735\n1709\n26\nB6\n83\nN503JB\nJFK\nSEA\n349\n2422\n13\n55\n2013-01-01 18:00:00\n\n\n2013\n1\n1\n1421\n1430\n-9\n1724\n1752\n-28\nDL\n1531\nN327NW\nLGA\nRSW\n160\n1080\n14\n30\n2013-01-01 19:00:00\n\n\n\n\n\n\nRetrieve the names of carriers that had flights departing from EWR with a delay greater than the average departure delay of all flights from EWR.\n\n\nWITH avg_dep_delay_ewr AS (\n    SELECT AVG(dep_delay) AS avg_dep_delay\n    FROM flights\n    WHERE origin = 'EWR'\n)\nSELECT DISTINCT a.name AS carrier_name\nFROM flights f\nJOIN avg_dep_delay_ewr avg ON f.dep_delay &gt; avg.avg_dep_delay\nJOIN airlines a ON f.carrier = a.carrier\nWHERE f.origin = 'EWR';\n\n\nDisplaying records 1 - 10\n\n\ncarrier_name\n\n\n\n\nAlaska Airlines Inc.\n\n\nSouthwest Airlines Co.\n\n\nJetBlue Airways\n\n\nVirgin America\n\n\nEnvoy Air\n\n\nAmerican Airlines Inc.\n\n\nDelta Air Lines Inc.\n\n\nExpressJet Airlines Inc.\n\n\nSkyWest Airlines Inc.\n\n\nUS Airways Inc.\n\n\n\n\n\n\nList the flight number, origin, and the maximum departure delay for flights on the same day.\n\n\nSELECT flight, origin, MAX(dep_delay) AS max_dep_delay\nFROM flights\nGROUP BY year, month, day, flight, origin;\n\n\nDisplaying records 1 - 10\n\n\nflight\norigin\nmax_dep_delay\n\n\n\n\n4255\nEWR\n-2\n\n\n3302\nEWR\n-7\n\n\n125\nJFK\n28\n\n\n1245\nEWR\n-4\n\n\n2147\nLGA\n-6\n\n\n1231\nLGA\n11\n\n\n505\nEWR\n57\n\n\n2054\nLGA\n-2\n\n\n1698\nEWR\n31\n\n\n4517\nLGA\n28\n\n\n\n\n\n\nFind all flights that had a departure delay greater than the average departure delay of their respective carrier.\n\n\nWITH avg_dep_delay_per_carrier AS (\n    SELECT carrier, AVG(dep_delay) AS avg_dep_delay\n    FROM flights\n    GROUP BY carrier\n)\nSELECT f.*\nFROM flights f\nJOIN avg_dep_delay_per_carrier ad\nON f.carrier = ad.carrier\nWHERE f.dep_delay &gt; ad.avg_dep_delay;\n\n\nDisplaying records 1 - 10\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nyear\nmonth\nday\ndep_time\nsched_dep_time\ndep_delay\narr_time\nsched_arr_time\narr_delay\ncarrier\nflight\ntailnum\norigin\ndest\nair_time\ndistance\nhour\nminute\ntime_hour\n\n\n\n\n2013\n1\n1\n632\n608\n24\n740\n728\n12\nEV\n4144\nN13553\nEWR\nIAD\n52\n212\n6\n8\n2013-01-01 11:00:00\n\n\n2013\n1\n1\n732\n645\n47\n1011\n941\n30\nUA\n1111\nN37456\nEWR\nMCO\n145\n937\n6\n45\n2013-01-01 11:00:00\n\n\n2013\n1\n1\n743\n730\n13\n1107\n1100\n7\nAA\n33\nN338AA\nJFK\nLAX\n358\n2475\n7\n30\n2013-01-01 12:00:00\n\n\n2013\n1\n1\n743\n730\n13\n1059\n1056\n3\nDL\n495\nN3760C\nJFK\nSEA\n349\n2422\n7\n30\n2013-01-01 12:00:00\n\n\n2013\n1\n1\n906\n843\n23\n1134\n1125\n9\nUA\n1643\nN17139\nEWR\nDEN\n246\n1605\n8\n43\n2013-01-01 13:00:00\n\n\n2013\n1\n1\n914\n900\n14\n1058\n1043\n15\nUA\n783\nN810UA\nEWR\nCLE\n85\n404\n9\n0\n2013-01-01 14:00:00\n\n\n2013\n1\n1\n920\n905\n15\n1039\n1025\n14\nB6\n1305\nN346JB\nJFK\nIAD\n52\n228\n9\n5\n2013-01-01 14:00:00\n\n\n2013\n1\n1\n921\n900\n21\n1237\n1227\n10\nDL\n120\nN713TW\nJFK\nLAX\n333\n2475\n9\n0\n2013-01-01 14:00:00\n\n\n2013\n1\n1\n930\n905\n25\n1218\n1209\n9\nUA\n1148\nN57439\nEWR\nTPA\n149\n997\n9\n5\n2013-01-01 14:00:00\n\n\n2013\n1\n1\n933\n904\n29\n1252\n1210\n42\nB6\n17\nN579JB\nJFK\nFLL\n170\n1069\n9\n4\n2013-01-01 14:00:00\n\n\n\n\n\n\nFor each carrier, find the average arrival delay and list carriers that have an average arrival delay of more than 10 minutes.\n\n\nSELECT carrier, avg_arr_delay\nFROM (\n    SELECT carrier, AVG(arr_delay) AS avg_arr_delay\n    FROM flights\n    GROUP BY carrier\n) AS avg_delays\nWHERE avg_arr_delay &gt; 10;\n\n\n5 records\n\n\ncarrier\navg_arr_delay\n\n\n\n\nEV\n15.79643\n\n\nF9\n21.75552\n\n\nFL\n19.52120\n\n\nOO\n11.93103\n\n\nYV\n15.55699\n\n\n\n\n\n\nList the tail numbers of planes that have flown more than the average distance of all flights.\n\n\nSELECT DISTINCT tailnum\nFROM flights\nWHERE distance &gt; (\n    SELECT AVG(distance)\n    FROM flights\n);\n\n\nDisplaying records 1 - 10\n\n\ntailnum\n\n\n\n\nN912XJ\n\n\nN454UA\n\n\nN645JB\n\n\nN280WN\n\n\nN904WN\n\n\nN14972\n\n\nN67052\n\n\nN667UA\n\n\nN521JB\n\n\nN563AS\n\n\n\n\n\n\nFind all flights that have corresponding weather data with a temperature higher than 80°F at the origin airport.\n\n\nSELECT *\nFROM flights f\nWHERE EXISTS (\n    SELECT 1\n    FROM weather w\n    WHERE f.origin = w.origin AND f.year = w.year AND f.month = w.month AND f.day = w.day AND w.temp &gt; 80\n);\n\n\nDisplaying records 1 - 10\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nyear\nmonth\nday\ndep_time\nsched_dep_time\ndep_delay\narr_time\nsched_arr_time\narr_delay\ncarrier\nflight\ntailnum\norigin\ndest\nair_time\ndistance\nhour\nminute\ntime_hour\n\n\n\n\n2013\n10\n1\n447\n500\n-13\n614\n648\n-34\nUS\n1877\nN538UW\nEWR\nCLT\n69\n529\n5\n0\n2013-10-01 09:00:00\n\n\n2013\n10\n1\n522\n517\n5\n735\n757\n-22\nUA\n252\nN556UA\nEWR\nIAH\n174\n1400\n5\n17\n2013-10-01 09:00:00\n\n\n2013\n10\n1\n536\n545\n-9\n809\n855\n-46\nAA\n2243\nN630AA\nJFK\nMIA\n132\n1089\n5\n45\n2013-10-01 09:00:00\n\n\n2013\n10\n1\n539\n545\n-6\n801\n827\n-26\nUA\n1714\nN37252\nLGA\nIAH\n172\n1416\n5\n45\n2013-10-01 09:00:00\n\n\n2013\n10\n1\n549\n600\n-11\n653\n716\n-23\nEV\n5716\nN830AS\nJFK\nIAD\n46\n228\n6\n0\n2013-10-01 10:00:00\n\n\n2013\n10\n1\n550\n600\n-10\n648\n700\n-12\nUS\n1909\nN949UW\nLGA\nPHL\n38\n96\n6\n0\n2013-10-01 10:00:00\n\n\n2013\n10\n1\n550\n600\n-10\n649\n659\n-10\nUS\n2167\nN749US\nLGA\nDCA\n39\n214\n6\n0\n2013-10-01 10:00:00\n\n\n2013\n10\n1\n551\n600\n-9\n727\n730\n-3\nUA\n279\nN415UA\nEWR\nORD\n117\n719\n6\n0\n2013-10-01 10:00:00\n\n\n2013\n10\n1\n551\n600\n-9\n710\n721\n-11\nUA\n1029\nN27722\nLGA\nORD\n114\n733\n6\n0\n2013-10-01 10:00:00\n\n\n2013\n10\n1\n551\n600\n-9\n655\n708\n-13\nB6\n2180\nN238JB\nEWR\nBOS\n40\n200\n6\n0\n2013-10-01 10:00:00\n\n\n\n\n\n\nList carriers that have more than 100 flights with departure delays.\n\n\nSELECT carrier, COUNT(*) AS num_flights\nFROM flights\nGROUP BY carrier\nHAVING COUNT(*) &gt; 100 AND COUNT(dep_delay) &gt; (\n    SELECT COUNT(*)\n    FROM flights\n    WHERE dep_delay IS NOT NULL\n);\n\n\n0 records\n\n\ncarrier\nnum_flights\n\n\n\n\n\n\n\n\nFind all planes that have not flown to JFK (John F. Kennedy International Airport).\n\n\nSELECT tailnum\nFROM planes\nWHERE tailnum NOT IN (\n    SELECT DISTINCT tailnum\n    FROM flights\n    WHERE dest = 'JFK'\n);\n\n\nDisplaying records 1 - 10\n\n\ntailnum\n\n\n\n\nN10156\n\n\nN102UW\n\n\nN103US\n\n\nN104UW\n\n\nN10575\n\n\nN105UW\n\n\nN107US\n\n\nN108UW\n\n\nN109UW\n\n\nN110UW\n\n\n\n\n\n\nList each flight along with the average departure delay for flights from the same origin on the same day.\n\n\nSELECT flight,\n       origin,\n       year,\n       month,\n       day,\n       AVG(dep_delay) AS avg_dep_delay\nFROM flights\nGROUP BY origin, year, month, day, flight;\n\n\nDisplaying records 1 - 10\n\n\nflight\norigin\nyear\nmonth\nday\navg_dep_delay\n\n\n\n\n746\nEWR\n2013\n10\n9\n-5\n\n\n127\nEWR\n2013\n10\n1\n3\n\n\n446\nEWR\n2013\n10\n11\n45\n\n\n4185\nEWR\n2013\n1\n9\n-8\n\n\n4364\nEWR\n2013\n1\n15\n-4\n\n\n4502\nEWR\n2013\n10\n23\n-6\n\n\n2379\nLGA\n2013\n1\n12\n-8\n\n\n1483\nEWR\n2013\n10\n18\n-3\n\n\n563\nLGA\n2013\n10\n3\n-6\n\n\n1715\nLGA\n2013\n1\n15\n-1"
  }
]