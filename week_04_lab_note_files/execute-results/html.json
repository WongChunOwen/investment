{
  "hash": "41fa18252b2c64f0369d92666f0e68a7",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: Week 04 Lab Lab Notes -- Sample 'PostgreSQL' questions Queries for Joining Tables\nauthor: Owen\ndate: 2024-05-24\ndate-format: \"dddd MMM D, YYYY\"\n\nformat: \n  html:\n    toc: true\n    toc-depth: 5\n    toc-location: left\n    number-sections: true\n    number-depth: 5\n---\n\n\n\n1. List all flights that were delayed more than 30 minutes on departure.\n\n\n::: {.cell}\n\n```{.sql .cell-code}\nSELECT *\nFROM flights\nWHERE dep_delay > 30;\n```\n\n\n<div class=\"knitsql-table\">\n\n\nTable: Displaying records 1 - 10\n\n| year| month| day| dep_time| sched_dep_time| dep_delay| arr_time| sched_arr_time| arr_delay|carrier | flight|tailnum |origin |dest | air_time| distance| hour| minute|time_hour           |\n|----:|-----:|---:|--------:|--------------:|---------:|--------:|--------------:|---------:|:-------|------:|:-------|:------|:----|--------:|--------:|----:|------:|:-------------------|\n| 2013|     1|   1|      732|            645|        47|     1011|            941|        30|UA      |   1111|N37456  |EWR    |MCO  |      145|      937|    6|     45|2013-01-01 11:00:00 |\n| 2013|     1|   1|      957|            733|       144|     1056|            853|       123|UA      |    856|N534UA  |EWR    |BOS  |       37|      200|    7|     33|2013-01-01 12:00:00 |\n| 2013|     1|   1|     1025|            951|        34|     1258|           1302|        -4|UA      |    501|N437UA  |EWR    |MCO  |      137|      937|    9|     51|2013-01-01 14:00:00 |\n| 2013|     1|   1|     1114|            900|       134|     1447|           1222|       145|UA      |   1086|N76502  |LGA    |IAH  |      248|     1416|    9|      0|2013-01-01 14:00:00 |\n| 2013|     1|   1|     1120|            944|        96|     1331|           1213|        78|EV      |   4495|N16561  |EWR    |SAV  |      117|      708|    9|     44|2013-01-01 14:00:00 |\n| 2013|     1|   1|     1253|           1212|        41|     1524|           1436|        48|UA      |    754|N576UA  |EWR    |DEN  |      252|     1605|   12|     12|2013-01-01 17:00:00 |\n| 2013|     1|   1|     1304|           1227|        37|     1518|           1422|        56|EV      |   4640|N19966  |EWR    |DAY  |      107|      533|   12|     27|2013-01-01 17:00:00 |\n| 2013|     1|   1|     1337|           1220|        77|     1649|           1531|        78|B6      |    673|N636JB  |JFK    |LAX  |      352|     2475|   12|     20|2013-01-01 17:00:00 |\n| 2013|     1|   1|     1355|           1315|        40|     1538|           1452|        46|EV      |   4552|N13958  |EWR    |GSO  |       86|      445|   13|     15|2013-01-01 18:00:00 |\n| 2013|     1|   1|     1356|           1259|        57|     1538|           1438|        60|UA      |     32|N17128  |EWR    |ORD  |      135|      719|   12|     59|2013-01-01 17:00:00 |\n\n</div>\n:::\n\n\n2. Retrieve the flight number, carrier name, and destination airport for all flights that departed from EWR (Newark Liberty International Airport).\n\n\n::: {.cell}\n\n```{.sql .cell-code}\nSELECT f.flight, a.name, f.dest\nFROM flights f\nJOIN airlines a ON f.carrier = a.carrier\nWHERE origin = 'EWR';\n\n```\n\n\n<div class=\"knitsql-table\">\n\n\nTable: Displaying records 1 - 10\n\n| flight|name                   |dest |\n|------:|:----------------------|:----|\n|   1545|United Air Lines Inc.  |IAH  |\n|   1696|United Air Lines Inc.  |ORD  |\n|    507|JetBlue Airways        |FLL  |\n|   1124|United Air Lines Inc.  |SFO  |\n|   1187|United Air Lines Inc.  |LAS  |\n|    343|JetBlue Airways        |PBI  |\n|   1895|American Airlines Inc. |MIA  |\n|   1077|United Air Lines Inc.  |MIA  |\n|    575|Delta Air Lines Inc.   |ATL  |\n|    245|US Airways Inc.        |PHX  |\n\n</div>\n:::\n\n\n3. Find the average arrival delay for each carrier.\n\n\n::: {.cell}\n\n```{.sql .cell-code}\nSELECT carrier, AVG(arr_delay) AS avg_arr_delay\nFROM flights\nGROUP BY carrier;\n```\n\n\n<div class=\"knitsql-table\">\n\n\nTable: Displaying records 1 - 10\n\n|carrier | avg_arr_delay|\n|:-------|-------------:|\n|9E      |      7.379669|\n|AA      |      0.204878|\n|AS      |     -9.930889|\n|B6      |      9.603291|\n|DL      |      1.887704|\n|EV      |     15.796431|\n|F9      |     21.755520|\n|FL      |     19.521202|\n|HA      |     -6.915205|\n|MQ      |      7.900958|\n\n</div>\n:::\n\n\n4. List the tail number, manufacturer, and model of planes that have flights departing from LGA (LaGuardia Airport).\n\n\n::: {.cell}\n\n```{.sql .cell-code}\nSELECT DISTINCT p.tailnum, p.manufacturer, p.model\nFROM flights f\nJOIN planes p ON f.tailnum = p.tailnum\nWHERE f.origin = 'LGA';\n```\n\n\n<div class=\"knitsql-table\">\n\n\nTable: Displaying records 1 - 10\n\n|tailnum |manufacturer      |model       |\n|:-------|:-----------------|:-----------|\n|N502MJ  |BOMBARDIER INC    |CL-600-2C10 |\n|N14923  |EMBRAER           |EMB-145LR   |\n|N627JB  |AIRBUS            |A320-232    |\n|N953DN  |MCDONNELL DOUGLAS |MD-90-30    |\n|N8665A  |BOMBARDIER INC    |CL-600-2B19 |\n|N8587E  |BOMBARDIER INC    |CL-600-2B19 |\n|N12218  |BOEING            |737-824     |\n|N557NW  |BOEING            |757-251     |\n|N825AS  |CANADAIR          |CL-600-2B19 |\n|N389DA  |BOEING            |737-832     |\n\n</div>\n:::\n\n\n5. Retrieve the flight number, origin, destination, and the name of the destination airport for flights that traveled more than 1000 miles.\n\n\n::: {.cell}\n\n```{.sql .cell-code}\nSELECT f.flight, f.origin, f.dest, a.name AS destination_airport_name\nFROM flights f\nJOIN airports a ON f.dest = a.faa\nWHERE f.distance > 1000;\n```\n\n\n<div class=\"knitsql-table\">\n\n\nTable: Displaying records 1 - 10\n\n| flight|origin |dest |destination_airport_name       |\n|------:|:------|:----|:------------------------------|\n|   1545|EWR    |IAH  |George Bush Intercontinental   |\n|   1714|LGA    |IAH  |George Bush Intercontinental   |\n|   1141|JFK    |MIA  |Miami Intl                     |\n|    507|EWR    |FLL  |Fort Lauderdale Hollywood Intl |\n|     49|JFK    |PBI  |Palm Beach Intl                |\n|     71|JFK    |TPA  |Tampa Intl                     |\n|    194|JFK    |LAX  |Los Angeles Intl               |\n|   1124|EWR    |SFO  |San Francisco Intl             |\n|   1187|EWR    |LAS  |Mc Carran Intl                 |\n|    371|LGA    |FLL  |Fort Lauderdale Hollywood Intl |\n\n</div>\n:::\n\n\n6. Find all planes that are in the planes table but did not have any recorded flights in the flights table.\n\n\n::: {.cell}\n\n```{.sql .cell-code}\nSELECT p.tailnum, p.manufacturer, p.model\nFROM planes p\nLEFT JOIN flights f ON p.tailnum = f.tailnum\nWHERE f.tailnum IS NULL;\n```\n\n\n<div class=\"knitsql-table\">\n\n\nTable: 0 records\n\n|tailnum |manufacturer |model |\n|:-------|:------------|:-----|\n\n</div>\n:::\n\n\n7. For each day, count the number of flights that were scheduled to depart.\n\n\n::: {.cell}\n\n```{.sql .cell-code}\nSELECT DATE_TRUNC('day', time_hour) AS day, COUNT(*) AS num_flights\nFROM flights\nGROUP BY DATE_TRUNC('day', time_hour)\nORDER BY day;\n```\n\n\n<div class=\"knitsql-table\">\n\n\nTable: Displaying records 1 - 10\n\n|day        | num_flights|\n|:----------|-----------:|\n|2013-01-01 |         566|\n|2013-01-02 |         764|\n|2013-01-03 |         750|\n|2013-01-04 |         743|\n|2013-01-05 |         624|\n|2013-01-06 |         638|\n|2013-01-07 |         760|\n|2013-01-08 |         746|\n|2013-01-09 |         737|\n|2013-01-10 |         765|\n\n</div>\n:::\n\n\n8. List the flights along with their corresponding weather conditions at the origin airport for January 1, 2013.\n\n\n::: {.cell}\n\n```{.sql .cell-code}\nSELECT f.flight, f.origin, w.temp, w.precip, w.wind_speed\nFROM flights f\nJOIN weather w ON f.origin = w.origin AND f.year = w.year AND f.month = w.month AND f.day = w.day AND f.hour = w.hour\nWHERE f.year = 2013 AND f.month = 1 AND f.day = 1;\n```\n\n\n<div class=\"knitsql-table\">\n\n\nTable: Displaying records 1 - 10\n\n| flight|origin |  temp| precip| wind_speed|\n|------:|:------|-----:|------:|----------:|\n|   1696|EWR    | 39.02|      0|   12.65858|\n|   1545|EWR    | 39.02|      0|   12.65858|\n|   1806|JFK    | 39.02|      0|   14.96014|\n|   1141|JFK    | 39.02|      0|   14.96014|\n|   1714|LGA    | 39.92|      0|   14.96014|\n|   1701|EWR    | 37.94|      0|   11.50780|\n|    507|EWR    | 37.94|      0|   11.50780|\n|   1496|EWR    | 37.94|      0|   11.50780|\n|   1111|EWR    | 37.94|      0|   11.50780|\n|   1187|EWR    | 37.94|      0|   11.50780|\n\n</div>\n:::\n\n\n9.  Find the carriers that have an average departure delay of more than 10 minutes. Find the carriers that have an average departure delay of more than 10 minutes.\n\n\n::: {.cell}\n\n```{.sql .cell-code}\nSELECT carrier, AVG(dep_delay) AS avg_dep_delay\nFROM flights\nGROUP BY carrier\nHAVING AVG(dep_delay) > 10;\n```\n\n\n<div class=\"knitsql-table\">\n\n\nTable: Displaying records 1 - 10\n\n|carrier | avg_dep_delay|\n|:-------|-------------:|\n|9E      |      16.72577|\n|B6      |      13.18561|\n|EV      |      19.95539|\n|F9      |      20.08976|\n|FL      |      18.28609|\n|OO      |      12.58621|\n|UA      |      12.11433|\n|VX      |      12.86942|\n|WN      |      17.71983|\n|YV      |      18.99633|\n\n</div>\n:::\n\n\n10. Retrieve the flight number, departure time, scheduled departure time, and manufacturer of planes that departed with a delay of more than 60 minutes.\n\n\n::: {.cell}\n\n```{.sql .cell-code}\nSELECT f.flight, f.dep_time, f.sched_dep_time, p.manufacturer\nFROM flights f\nJOIN planes p ON f.tailnum = p.tailnum\nWHERE f.dep_delay > 60;\n```\n\n\n<div class=\"knitsql-table\">\n\n\nTable: Displaying records 1 - 10\n\n| flight| dep_time| sched_dep_time|manufacturer     |\n|------:|--------:|--------------:|:----------------|\n|    856|      957|            733|BOEING           |\n|   1086|     1114|            900|BOEING           |\n|   4495|     1120|            944|EMBRAER          |\n|    673|     1337|           1220|AIRBUS           |\n|   4869|     1400|           1250|BOMBARDIER INC   |\n|   4497|     1505|           1310|EMBRAER          |\n|    525|     1525|           1340|EMBRAER          |\n|   4181|     1549|           1445|EMBRAER          |\n|   5712|     1558|           1359|CANADAIR         |\n|    465|     1607|           1443|AIRBUS INDUSTRIE |\n\n</div>\n:::\n\n\n11. List all flights that departed after the average departure time on January 1, 2013.\n\n\n::: {.cell}\n\n```{.sql .cell-code}\nSELECT *\nFROM flights\nWHERE dep_time > (\n    SELECT AVG(dep_time)\n    FROM flights\n    WHERE year = 2013 AND month = 1 AND day = 1\n) AND year = 2013 AND month = 1 AND day = 1;\n```\n\n\n<div class=\"knitsql-table\">\n\n\nTable: Displaying records 1 - 10\n\n| year| month| day| dep_time| sched_dep_time| dep_delay| arr_time| sched_arr_time| arr_delay|carrier | flight|tailnum |origin |dest | air_time| distance| hour| minute|time_hour           |\n|----:|-----:|---:|--------:|--------------:|---------:|--------:|--------------:|---------:|:-------|------:|:-------|:------|:----|--------:|--------:|----:|------:|:-------------------|\n| 2013|     1|   1|     1400|           1250|        70|     1645|           1502|       103|EV      |   4869|N748EV  |LGA    |MEM  |      178|      963|   12|     50|2013-01-01 17:00:00 |\n| 2013|     1|   1|     1400|           1400|         0|     1634|           1636|        -2|DL      |   2247|N6704Z  |LGA    |ATL  |      130|      762|   14|      0|2013-01-01 19:00:00 |\n| 2013|     1|   1|     1402|           1323|        39|     1650|           1526|        84|EV      |   4516|N13123  |EWR    |MEM  |      183|      946|   13|     23|2013-01-01 18:00:00 |\n| 2013|     1|   1|     1408|           1411|        -3|     1646|           1640|         6|FL      |    349|N895AT  |LGA    |ATL  |      133|      762|   14|     11|2013-01-01 19:00:00 |\n| 2013|     1|   1|     1411|           1315|        56|     1717|           1611|        66|B6      |    505|N516JB  |EWR    |FLL  |      154|     1065|   13|     15|2013-01-01 18:00:00 |\n| 2013|     1|   1|     1416|           1411|         5|     1603|           1549|        14|UA      |    683|N456UA  |EWR    |ORD  |      136|      719|   14|     11|2013-01-01 19:00:00 |\n| 2013|     1|   1|     1418|           1419|        -1|     1726|           1732|        -6|UA      |     16|N37464  |EWR    |SEA  |      348|     2402|   14|     19|2013-01-01 19:00:00 |\n| 2013|     1|   1|     1421|           1422|        -1|     1517|           1535|       -18|B6      |   1010|N274JB  |JFK    |BOS  |       38|      187|   14|     22|2013-01-01 19:00:00 |\n| 2013|     1|   1|     1421|           1355|        26|     1735|           1709|        26|B6      |     83|N503JB  |JFK    |SEA  |      349|     2422|   13|     55|2013-01-01 18:00:00 |\n| 2013|     1|   1|     1421|           1430|        -9|     1724|           1752|       -28|DL      |   1531|N327NW  |LGA    |RSW  |      160|     1080|   14|     30|2013-01-01 19:00:00 |\n\n</div>\n:::\n\n\n12. Retrieve the names of carriers that had flights departing from EWR with a delay greater than the average departure delay of all flights from EWR.\n\n\n::: {.cell}\n\n```{.sql .cell-code}\nWITH avg_dep_delay_ewr AS (\n    SELECT AVG(dep_delay) AS avg_dep_delay\n    FROM flights\n    WHERE origin = 'EWR'\n)\nSELECT DISTINCT a.name AS carrier_name\nFROM flights f\nJOIN avg_dep_delay_ewr avg ON f.dep_delay > avg.avg_dep_delay\nJOIN airlines a ON f.carrier = a.carrier\nWHERE f.origin = 'EWR';\n\n```\n\n\n<div class=\"knitsql-table\">\n\n\nTable: Displaying records 1 - 10\n\n|carrier_name             |\n|:------------------------|\n|Alaska Airlines Inc.     |\n|Southwest Airlines Co.   |\n|JetBlue Airways          |\n|Virgin America           |\n|Envoy Air                |\n|American Airlines Inc.   |\n|Delta Air Lines Inc.     |\n|ExpressJet Airlines Inc. |\n|SkyWest Airlines Inc.    |\n|US Airways Inc.          |\n\n</div>\n:::\n\n\n13. List the flight number, origin, and the maximum departure delay for flights on the same day.\n\n\n::: {.cell}\n\n```{.sql .cell-code}\nSELECT flight, origin, MAX(dep_delay) AS max_dep_delay\nFROM flights\nGROUP BY year, month, day, flight, origin;\n```\n\n\n<div class=\"knitsql-table\">\n\n\nTable: Displaying records 1 - 10\n\n| flight|origin | max_dep_delay|\n|------:|:------|-------------:|\n|   4255|EWR    |            -2|\n|   3302|EWR    |            -7|\n|    125|JFK    |            28|\n|   1245|EWR    |            -4|\n|   2147|LGA    |            -6|\n|   1231|LGA    |            11|\n|    505|EWR    |            57|\n|   2054|LGA    |            -2|\n|   1698|EWR    |            31|\n|   4517|LGA    |            28|\n\n</div>\n:::\n\n\n\n14. Find all flights that had a departure delay greater than the average departure delay of their respective carrier.\n\n\n::: {.cell}\n\n```{.sql .cell-code}\nWITH avg_dep_delay_per_carrier AS (\n    SELECT carrier, AVG(dep_delay) AS avg_dep_delay\n    FROM flights\n    GROUP BY carrier\n)\nSELECT f.*\nFROM flights f\nJOIN avg_dep_delay_per_carrier ad\nON f.carrier = ad.carrier\nWHERE f.dep_delay > ad.avg_dep_delay;\n\n```\n\n\n<div class=\"knitsql-table\">\n\n\nTable: Displaying records 1 - 10\n\n| year| month| day| dep_time| sched_dep_time| dep_delay| arr_time| sched_arr_time| arr_delay|carrier | flight|tailnum |origin |dest | air_time| distance| hour| minute|time_hour           |\n|----:|-----:|---:|--------:|--------------:|---------:|--------:|--------------:|---------:|:-------|------:|:-------|:------|:----|--------:|--------:|----:|------:|:-------------------|\n| 2013|     1|   1|      632|            608|        24|      740|            728|        12|EV      |   4144|N13553  |EWR    |IAD  |       52|      212|    6|      8|2013-01-01 11:00:00 |\n| 2013|     1|   1|      732|            645|        47|     1011|            941|        30|UA      |   1111|N37456  |EWR    |MCO  |      145|      937|    6|     45|2013-01-01 11:00:00 |\n| 2013|     1|   1|      743|            730|        13|     1107|           1100|         7|AA      |     33|N338AA  |JFK    |LAX  |      358|     2475|    7|     30|2013-01-01 12:00:00 |\n| 2013|     1|   1|      743|            730|        13|     1059|           1056|         3|DL      |    495|N3760C  |JFK    |SEA  |      349|     2422|    7|     30|2013-01-01 12:00:00 |\n| 2013|     1|   1|      906|            843|        23|     1134|           1125|         9|UA      |   1643|N17139  |EWR    |DEN  |      246|     1605|    8|     43|2013-01-01 13:00:00 |\n| 2013|     1|   1|      914|            900|        14|     1058|           1043|        15|UA      |    783|N810UA  |EWR    |CLE  |       85|      404|    9|      0|2013-01-01 14:00:00 |\n| 2013|     1|   1|      920|            905|        15|     1039|           1025|        14|B6      |   1305|N346JB  |JFK    |IAD  |       52|      228|    9|      5|2013-01-01 14:00:00 |\n| 2013|     1|   1|      921|            900|        21|     1237|           1227|        10|DL      |    120|N713TW  |JFK    |LAX  |      333|     2475|    9|      0|2013-01-01 14:00:00 |\n| 2013|     1|   1|      930|            905|        25|     1218|           1209|         9|UA      |   1148|N57439  |EWR    |TPA  |      149|      997|    9|      5|2013-01-01 14:00:00 |\n| 2013|     1|   1|      933|            904|        29|     1252|           1210|        42|B6      |     17|N579JB  |JFK    |FLL  |      170|     1069|    9|      4|2013-01-01 14:00:00 |\n\n</div>\n:::\n\n15. For each carrier, find the average arrival delay and list carriers that have an average arrival delay of more than 10 minutes.\n\n\n::: {.cell}\n\n```{.sql .cell-code}\nSELECT carrier, avg_arr_delay\nFROM (\n    SELECT carrier, AVG(arr_delay) AS avg_arr_delay\n    FROM flights\n    GROUP BY carrier\n) AS avg_delays\nWHERE avg_arr_delay > 10;\n```\n\n\n<div class=\"knitsql-table\">\n\n\nTable: 5 records\n\n|carrier | avg_arr_delay|\n|:-------|-------------:|\n|EV      |      15.79643|\n|F9      |      21.75552|\n|FL      |      19.52120|\n|OO      |      11.93103|\n|YV      |      15.55699|\n\n</div>\n:::\n\n\n16. List the tail numbers of planes that have flown more than the average distance of all flights.\n\n\n::: {.cell}\n\n```{.sql .cell-code}\nSELECT DISTINCT tailnum\nFROM flights\nWHERE distance > (\n    SELECT AVG(distance)\n    FROM flights\n);\n```\n\n\n<div class=\"knitsql-table\">\n\n\nTable: Displaying records 1 - 10\n\n|tailnum |\n|:-------|\n|N912XJ  |\n|N454UA  |\n|N645JB  |\n|N280WN  |\n|N904WN  |\n|N14972  |\n|N67052  |\n|N667UA  |\n|N521JB  |\n|N563AS  |\n\n</div>\n:::\n\n\n17. Find all flights that have corresponding weather data with a temperature higher than 80°F at the origin airport.\n\n\n::: {.cell}\n\n```{.sql .cell-code}\nSELECT *\nFROM flights f\nWHERE EXISTS (\n    SELECT 1\n    FROM weather w\n    WHERE f.origin = w.origin AND f.year = w.year AND f.month = w.month AND f.day = w.day AND w.temp > 80\n);\n```\n\n\n<div class=\"knitsql-table\">\n\n\nTable: Displaying records 1 - 10\n\n| year| month| day| dep_time| sched_dep_time| dep_delay| arr_time| sched_arr_time| arr_delay|carrier | flight|tailnum |origin |dest | air_time| distance| hour| minute|time_hour           |\n|----:|-----:|---:|--------:|--------------:|---------:|--------:|--------------:|---------:|:-------|------:|:-------|:------|:----|--------:|--------:|----:|------:|:-------------------|\n| 2013|    10|   1|      447|            500|       -13|      614|            648|       -34|US      |   1877|N538UW  |EWR    |CLT  |       69|      529|    5|      0|2013-10-01 09:00:00 |\n| 2013|    10|   1|      522|            517|         5|      735|            757|       -22|UA      |    252|N556UA  |EWR    |IAH  |      174|     1400|    5|     17|2013-10-01 09:00:00 |\n| 2013|    10|   1|      536|            545|        -9|      809|            855|       -46|AA      |   2243|N630AA  |JFK    |MIA  |      132|     1089|    5|     45|2013-10-01 09:00:00 |\n| 2013|    10|   1|      539|            545|        -6|      801|            827|       -26|UA      |   1714|N37252  |LGA    |IAH  |      172|     1416|    5|     45|2013-10-01 09:00:00 |\n| 2013|    10|   1|      549|            600|       -11|      653|            716|       -23|EV      |   5716|N830AS  |JFK    |IAD  |       46|      228|    6|      0|2013-10-01 10:00:00 |\n| 2013|    10|   1|      550|            600|       -10|      648|            700|       -12|US      |   1909|N949UW  |LGA    |PHL  |       38|       96|    6|      0|2013-10-01 10:00:00 |\n| 2013|    10|   1|      550|            600|       -10|      649|            659|       -10|US      |   2167|N749US  |LGA    |DCA  |       39|      214|    6|      0|2013-10-01 10:00:00 |\n| 2013|    10|   1|      551|            600|        -9|      727|            730|        -3|UA      |    279|N415UA  |EWR    |ORD  |      117|      719|    6|      0|2013-10-01 10:00:00 |\n| 2013|    10|   1|      551|            600|        -9|      710|            721|       -11|UA      |   1029|N27722  |LGA    |ORD  |      114|      733|    6|      0|2013-10-01 10:00:00 |\n| 2013|    10|   1|      551|            600|        -9|      655|            708|       -13|B6      |   2180|N238JB  |EWR    |BOS  |       40|      200|    6|      0|2013-10-01 10:00:00 |\n\n</div>\n:::\n\n\n18. List carriers that have more than 100 flights with departure delays.\n\n\n::: {.cell}\n\n```{.sql .cell-code}\nSELECT carrier, COUNT(*) AS num_flights\nFROM flights\nGROUP BY carrier\nHAVING COUNT(*) > 100 AND COUNT(dep_delay) > (\n    SELECT COUNT(*)\n    FROM flights\n    WHERE dep_delay IS NOT NULL\n);\n```\n\n\n<div class=\"knitsql-table\">\n\n\nTable: 0 records\n\n|carrier | num_flights|\n|:-------|-----------:|\n\n</div>\n:::\n\n\n19. Find all planes that have not flown to JFK (John F. Kennedy International Airport).\n\n\n::: {.cell}\n\n```{.sql .cell-code}\nSELECT tailnum\nFROM planes\nWHERE tailnum NOT IN (\n    SELECT DISTINCT tailnum\n    FROM flights\n    WHERE dest = 'JFK'\n);\n```\n\n\n<div class=\"knitsql-table\">\n\n\nTable: Displaying records 1 - 10\n\n|tailnum |\n|:-------|\n|N10156  |\n|N102UW  |\n|N103US  |\n|N104UW  |\n|N10575  |\n|N105UW  |\n|N107US  |\n|N108UW  |\n|N109UW  |\n|N110UW  |\n\n</div>\n:::\n\n\n20. List each flight along with the average departure delay for flights from the same origin on the same day.\n\n\n::: {.cell}\n\n```{.sql .cell-code}\nSELECT flight,\n       origin,\n       year,\n       month,\n       day,\n       AVG(dep_delay) AS avg_dep_delay\nFROM flights\nGROUP BY origin, year, month, day, flight;\n\n```\n\n\n<div class=\"knitsql-table\">\n\n\nTable: Displaying records 1 - 10\n\n| flight|origin | year| month| day| avg_dep_delay|\n|------:|:------|----:|-----:|---:|-------------:|\n|    746|EWR    | 2013|    10|   9|            -5|\n|    127|EWR    | 2013|    10|   1|             3|\n|    446|EWR    | 2013|    10|  11|            45|\n|   4185|EWR    | 2013|     1|   9|            -8|\n|   4364|EWR    | 2013|     1|  15|            -4|\n|   4502|EWR    | 2013|    10|  23|            -6|\n|   2379|LGA    | 2013|     1|  12|            -8|\n|   1483|EWR    | 2013|    10|  18|            -3|\n|    563|LGA    | 2013|    10|   3|            -6|\n|   1715|LGA    | 2013|     1|  15|            -1|\n\n</div>\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}